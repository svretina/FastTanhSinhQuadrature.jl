<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theory · FastTanhSinhQuadrature.jl</title><meta name="title" content="Theory · FastTanhSinhQuadrature.jl"/><meta property="og:title" content="Theory · FastTanhSinhQuadrature.jl"/><meta property="twitter:title" content="Theory · FastTanhSinhQuadrature.jl"/><meta name="description" content="Documentation for FastTanhSinhQuadrature.jl."/><meta property="og:description" content="Documentation for FastTanhSinhQuadrature.jl."/><meta property="twitter:description" content="Documentation for FastTanhSinhQuadrature.jl."/><meta property="og:url" content="https://svretina.github.io/FastTanhSinhQuadrature.jl/theory/"/><meta property="twitter:url" content="https://svretina.github.io/FastTanhSinhQuadrature.jl/theory/"/><link rel="canonical" href="https://svretina.github.io/FastTanhSinhQuadrature.jl/theory/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="FastTanhSinhQuadrature.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">FastTanhSinhQuadrature.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Theory</a><ul class="internal"><li><a class="tocitem" href="#Reference"><span>Reference</span></a></li><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Transformation-Visualization"><span>Transformation Visualization</span></a></li><li><a class="tocitem" href="#Discretization"><span>Discretization</span></a></li><li><a class="tocitem" href="#Error-Estimation-and-Convergence"><span>Error Estimation and Convergence</span></a></li><li><a class="tocitem" href="#Optimal-Step-Size-and-Truncation"><span>Optimal Step Size and Truncation</span></a></li><li><a class="tocitem" href="#Numerical-Stability-Notes"><span>Numerical Stability Notes</span></a></li><li><a class="tocitem" href="#Singular-Integral-Handling"><span>Singular Integral Handling</span></a></li></ul></li><li><a class="tocitem" href="../convergence/">Convergence</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/basics/">Basic Usage</a></li><li><a class="tocitem" href="../examples/advanced/">Advanced Usage</a></li></ul></li><li><a class="tocitem" href="../benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Theory</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Theory</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/svretina/FastTanhSinhQuadrature.jl/blob/master/docs/src/theory.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tanh-Sinh-Quadrature"><a class="docs-heading-anchor" href="#Tanh-Sinh-Quadrature">Tanh-Sinh Quadrature</a><a id="Tanh-Sinh-Quadrature-1"></a><a class="docs-heading-anchor-permalink" href="#Tanh-Sinh-Quadrature" title="Permalink"></a></h1><h2 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h2><p>The Tanh-Sinh (Double Exponential) quadrature method was introduced by:</p><blockquote><p><strong>Double Exponential Formulas for Numerical Integration</strong>   Hidetosi Takahasi, Masatake Mori   <em>Publ. Res. Inst. Math. Sci.</em> 9 (1973), no. 3, pp. 721–741   DOI: <a href="https://doi.org/10.2977/PRIMS/1195192451">10.2977/PRIMS/1195192451</a></p></blockquote><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The quadrature computes integrals of the form</p><p class="math-container">\[\mathcal{I}=\int_{-1}^1 f(x) dx.\]</p><p>The method is based on a variable transformation which maps the original domain <span>$x \in (-1,1)$</span> onto the entire real axis <span>$t \in (-\infty, \infty)$</span> using the transformation:</p><p class="math-container">\[x = \Psi(t) = \tanh\left(\frac{\pi}{2} \sinh t\right)\]</p><p>The derivative (Jacobian) of this transformation is:</p><p class="math-container">\[\Psi&#39;(t) = \frac{\frac{\pi}{2} \cosh t}{\cosh^2\left(\frac{\pi}{2} \sinh t\right)}\]</p><p>The integral then becomes:</p><p class="math-container">\[\mathcal{I} = \int_{-\infty}^\infty g(t) dt, \quad g(t)= f(\Psi(t)) \Psi&#39;(t)\]</p><p>Since the method is specific for the <span>$x \in (-1,1)$</span> domain, one must cast the desired integral to this domain by the linear substitution:</p><p class="math-container">\[x(u)=\frac{b+a}{2}+\frac{b-a}{2}u\]</p><p>This transformation changes an arbitrary interval <span>$[a,b]$</span> to <span>$[-1,1]$</span>, hence</p><p class="math-container">\[\int_a^b f(x)dx= \frac{b-a}{2}\int_{-1}^1 f(x(u))du = \frac{b-a}{2}\int_{-\infty}^\infty f(x(u(t))) w(t) dt\]</p><h2 id="Transformation-Visualization"><a class="docs-heading-anchor" href="#Transformation-Visualization">Transformation Visualization</a><a id="Transformation-Visualization-1"></a><a class="docs-heading-anchor-permalink" href="#Transformation-Visualization" title="Permalink"></a></h2><p>The key to the Tanh-Sinh quadrature&#39;s effectiveness lies in how the transformation maps the integration points. While the discretization in the transformed <span>$t$</span>-domain uses equidistant notes (<span>$t_i = ih$</span>), the mapping <span>$x = \tanh(\frac{\pi}{2} \sinh t)$</span> causes these corresponding <span>$x_i$</span> nodes to cluster <strong>double exponentially</strong> fast near the endpoints <span>$-1$</span> and <span>$+1$</span> of the original domain. This dense clustering allows the quadrature to accurately resolve functions even when they have singularities at the boundaries, as the weights decay rapidly enough to suppress the singularity.</p><div style="text-align: center;">
  <img src="figure_1.png" alt="Transformation Visualization" width="400">
  <br>
  <em>Figure 1: Visualization of the Tanh-Sinh variable transformation. Source: <a href="https://arxiv.org/abs/2007.15057">arXiv:2007.15057</a>.</em>
</div><h2 id="Discretization"><a class="docs-heading-anchor" href="#Discretization">Discretization</a><a id="Discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Discretization" title="Permalink"></a></h2><p>We approximate the infinite integral using the trapezoidal rule with step size <span>$h$</span>:</p><p class="math-container">\[\mathcal{I}_h = \sum_{i=-\infty}^{\infty} h g(t_i) = \sum_{i=-\infty}^{\infty} h \Psi&#39;(t_i) f(\Psi(t_i))\]</p><p>where <span>$t_i = ih$</span>. Because the transformed integrand <span>$g(t)$</span> decays double exponentially (like <span>$\exp(-\frac{\pi}{2} e^{|t|})$</span>) as <span>$|t| \to \infty$</span>, we can truncate the infinite sum to a finite window <span>$[-t_n, t_n]$</span> with negligible error:</p><p class="math-container">\[\mathcal{I} \approx Q_h^n = \sum_{i=-n}^{n} h \Psi&#39;(t_i) f(\Psi(t_i))\]</p><h2 id="Error-Estimation-and-Convergence"><a class="docs-heading-anchor" href="#Error-Estimation-and-Convergence">Error Estimation and Convergence</a><a id="Error-Estimation-and-Convergence-1"></a><a class="docs-heading-anchor-permalink" href="#Error-Estimation-and-Convergence" title="Permalink"></a></h2><p>For an integrand <span>$f(x)$</span> that is regular in a strip of width <span>$d$</span> in the complex plane around the interval <span>$[-1, 1]$</span>, the error of the tanh-sinh quadrature decreases exponentially with the number of evaluation points <span>$N = 2n+1$</span>. Specifically, the error is of the order:</p><p class="math-container">\[|\mathcal{I} - Q_h^n| \approx \mathcal{O}\left(\exp\left(-\frac{\pi d N}{\ln(2 d N)}\right)\right)\]</p><p>This rapid convergence rate is the hallmark of double exponential formulas. See the <a href="../convergence/">Convergence</a> page for empirical results.</p><h2 id="Optimal-Step-Size-and-Truncation"><a class="docs-heading-anchor" href="#Optimal-Step-Size-and-Truncation">Optimal Step Size and Truncation</a><a id="Optimal-Step-Size-and-Truncation-1"></a><a class="docs-heading-anchor-permalink" href="#Optimal-Step-Size-and-Truncation" title="Permalink"></a></h2><p>The choice of the step size <span>$h$</span> and the number of points <span>$N$</span> are coupled. To balance the discretization error (from the trapezoidal rule) and the truncation error (from cutting off the infinite sum), the optimal step size <span>$h$</span> for a given <span>$N$</span> is approximately:</p><p class="math-container">\[h_{opt} \approx \frac{2}{N} \ln(\pi d N)\]</p><p>However, in floating-point arithmetic, we are limited by the machine precision. We cannot transform points arbitrarily close to <span>$\pm 1$</span> without hitting the underflow limit or precision bound of the floating-point type.</p><p>This leads to a <strong>maximal step size</strong> constraint to ensure numerical stability. If <span>$t_{max}$</span> is the largest argument such that we can still distinguish <span>$\Psi(t_{max})$</span> from <span>$1$</span> (or weights from <span>$0$</span>), then we must have:</p><p class="math-container">\[h_{max} = \frac{t_{max}}{n}\]</p><p>Typically, <span>$t_{max}$</span> is determined by the condition where the weights <span>$\Psi&#39;(t)$</span> underflow to zero or the nodes <span>$\Psi(t)$</span> become indistinguishable from <span>$\pm 1$</span> in the given precision.</p><h2 id="Numerical-Stability-Notes"><a class="docs-heading-anchor" href="#Numerical-Stability-Notes">Numerical Stability Notes</a><a id="Numerical-Stability-Notes-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Stability-Notes" title="Permalink"></a></h2><p>When dealing with finite precision floating point numbers, numerical instabilities can arise.</p><p>The quadrature scheme depends crucially on the evaluations very close to the end-points of the integration domain. The most important cause of numerical instabilities is numerical underflow.</p><p>Both the smallest weight and abscissa value are determined by the window size <span>$t_n$</span>. The smallest positive normalized floating point number is <span>$F_{\min}=2^L$</span>.</p><p>For the weights to avoid the numerical underflow we need:</p><p class="math-container">\[t_{\max}^w = \max\{ t\,|\, \Psi&#39;(t) \geq F_{\min}\}\]</p><p>Similarly the smallest abscissa should exceed the machine epsilon / underflow limit relative to the endpoint:</p><p class="math-container">\[t_{\max}^x = \max\{ t \,|\, t \leq \Psi^{-1}(1-F_{\min})\}\]</p><p>Since these conditions need to be satisfied simultaneously we introduce:</p><p class="math-container">\[t_{\max}^{xw} = \min\{ t_{\max}^x, \,t_{\max}^w \}\]</p><p>It is crucial to ensure <span>$h$</span> is chosen such that <span>$nh \le t_{max}^{xw}$</span>. These limits ensure that the quadrature points remain within the range where the function <span>$f(x)$</span> can be reliably evaluated and where the Jacobian weights carry meaningful values without underflowing to zero.</p><h3 id="Adaptive-Integration-Strategy"><a class="docs-heading-anchor" href="#Adaptive-Integration-Strategy">Adaptive Integration Strategy</a><a id="Adaptive-Integration-Strategy-1"></a><a class="docs-heading-anchor-permalink" href="#Adaptive-Integration-Strategy" title="Permalink"></a></h3><p>To achieve a desired accuracy without manually tuning the number of points <span>$N$</span>, we implement an adaptive refinement strategy:</p><ol><li><strong>Grid Refinement</strong>: Starting from a coarse step size <span>$h_0 \approx t_{max}/2$</span>, we halve the step size at each iteration (<span>$h_{k+1} = h_k / 2$</span>).</li><li><strong>Node Reuse</strong>: Because <span>$h_{k+1} = h_k / 2$</span>, all nodes from iteration <span>$k$</span> are preserved in iteration <span>$k+1$</span> (they correspond to the even-indexed nodes <span>$x_{2i}^{k+1}$</span>).</li><li><strong>Efficiency</strong>: At each step, we only evaluate the function at the <strong>new</strong> nodes (odd indices <span>$x_{2i+1}^{k+1}$</span> in the refined grid). This reduces the number of expensive function calls by a factor of 2 compared to recomputing the whole sum.</li><li><strong>Multi-Dimensional Symmetry</strong>: we exploit the symmetry of the Tanh-Sinh weights (<span>$w(t) = w(-t)$</span>) and nodes (<span>$\Psi(t) = -\Psi(-t)$</span>). For 2D and 3D integrals, this means we only iterate over one &quot;corner&quot; of the domain and use reflections (4-way in 2D, 8-way in 3D) to accumulate the final sum.</li></ol><h2 id="Singular-Integral-Handling"><a class="docs-heading-anchor" href="#Singular-Integral-Handling">Singular Integral Handling</a><a id="Singular-Integral-Handling-1"></a><a class="docs-heading-anchor-permalink" href="#Singular-Integral-Handling" title="Permalink"></a></h2><p>One of the primary advantages of Tanh-Sinh quadrature is its ability to handle <strong>boundary singularities</strong>. Because the transformation maps the endpoints to infinity and clusters points double-exponentially near them, the function is never evaluated exactly at the boundary. For functions like <span>$\int_0^1 \log(x)dx$</span> or <span>$\int_{-1}^1 (1-x^2)^{-1/2}dx$</span>, the quadrature typically reaches high accuracy without any special treatment.</p><h3 id="Internal-Singularities-and-Domain-Splitting"><a class="docs-heading-anchor" href="#Internal-Singularities-and-Domain-Splitting">Internal Singularities and Domain Splitting</a><a id="Internal-Singularities-and-Domain-Splitting-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-Singularities-and-Domain-Splitting" title="Permalink"></a></h3><p>If a singularity exists <strong>inside</strong> the integration domain (e.g., <span>$\int_{-1}^1 |x|^{-1/2}dx$</span> at <span>$x=0$</span>), the standard Tanh-Sinh approach may fail or converge very slowly because the high-density node regions (the &quot;exponential tails&quot;) are at the boundaries, not the interior.</p><p>To handle this, we provide the <code>quad_split</code> function. It allows the user to specify the location of the internal singularity. The function then:</p><ol><li>Splits the domain into sub-regions (2 segments in 1D, 4 rectangles in 2D, or 8 boxes in 3D) where the singularity is on the <strong>boundary</strong> of each sub-region.</li><li>Integrates each sub-region using the standard <code>quad</code> function.</li><li>Sums the results.</li></ol><p>This transforms an internal singularity into several boundary singularities, which Tanh-Sinh then handles with its characteristic efficiency.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../convergence/">Convergence »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 3 February 2026 20:38">Tuesday 3 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
